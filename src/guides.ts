export interface GuideStep { title: string; subs?: string[]; }

export const guides: Record<'en' | 'de', Record<string, GuideStep[]>> = {
    en: {
        rras: [
            { title: "Use the button below to open the Routing and Remote Access console (rrasmgmt.msc)." },
            { title: "Right-click the server name \u2192 Configure and Enable Routing and Remote Access." },
            { title: "Select Custom Configuration \u2192 enable VPN access. Complete the wizard and start the service when prompted." },
            { title: "IP Address Assignment: Right-click server name \u2192 Properties \u2192 IPv4 tab.", subs: ["Choose DHCP or define a static address pool (click Add, e.g. 10.10.10.1 \u2013 10.10.10.254)."] },
            { title: "Certificate & Authentication: Right-click server name \u2192 Properties \u2192 Security tab.", subs: ["Select the SSL certificate for your external VPN address (e.g. vpn.company.com) for SSTP.", "Click Authentication Methods\u2026 and ensure Extensible Authentication Protocol (EAP) is enabled."] },
            { title: "Configure Ports: Expand server tree, right-click Ports \u2192 Properties.", subs: ["Set IKEv2 ports (e.g. 128, enable \u2018Remote access connections\u2019).", "Set SSTP ports (e.g. 128, enable \u2018Remote access connections\u2019).", "Disable PPTP and L2TP by setting port count to 0 and unchecking RAS."] },
            { title: "Firewall Rules: Ensure the following ports are open on Windows Firewall and any perimeter firewall:", subs: ["TCP 443 (SSTP)", "UDP 500 (IKEv2 ISAKMP)", "UDP 4500 (IKEv2 NAT-T)", "If RRAS is behind a NAT device, ensure NAT-Traversal (NAT-T) is supported."] },
            { title: "Restart Service: Right-click server name \u2192 All Tasks \u2192 Restart to apply all changes." },
        ],
        nps: [
            { title: "Register NPS: Open the NPS console. Right-click \u2018NPS\u2019 at the top and select Register Server in Active Directory." },
            { title: "RADIUS Clients: Expand RADIUS Clients and Servers. Right-click RADIUS Clients \u2192 New.", subs: ["Friendly name: Local-RRAS", "Address (IP): 127.0.0.1", "Enter and confirm a strong manual Shared Secret."] },
            { title: "Connection Request Policies: Expand Policies \u2192 Right-click Connection Request Policies \u2192 New.", subs: ["Name: AOVPN Connection Request. Type: \u2018Remote Access Server (VPN-Dial up)\u2019.", "Conditions: Add NAS Port Type and select Virtual (VPN).", "Forwarding: Leave authentication on the local server. Finish."] },
            { title: "Network Policies (Device Tunnel): Right-click Network Policies \u2192 New.", subs: ["Name: AOVPN Device Tunnel. Type: \u2018Remote Access Server (VPN-Dial up)\u2019. Grant access.", "Conditions: NAS Port Type = Virtual (VPN) AND Computer Groups = (your AD security group for VPN devices).", "Authentication: Enable ONLY \u2018Extensible Authentication Protocol (EAP)\u2019. Add Microsoft: Smart Card or other certificate. Disable MS-CHAPv2!", "Edit the EAP type and ensure the RRAS server certificate is selected."] },
            { title: "Network Policies (User Tunnel): Create another network policy (or duplicate/adapt).", subs: ["Name: AOVPN User Tunnel. Type: \u2018Remote Access Server (VPN-Dial up)\u2019. Grant access.", "Conditions: NAS Port Type = Virtual (VPN) AND User Groups = (your AD security group for VPN users).", "Authentication: Add Microsoft: Smart Card or other certificate (or PEAP for Windows Hello). Edit and select server certificate."] },
            { title: "Policy Order: NPS evaluates policies top-to-bottom. Ensure the Device Tunnel policy is ABOVE the User Tunnel policy.", subs: ["Right-click each policy to change its Processing Order if needed.", "If ordering is wrong, device connections may be matched by the user policy and rejected."] },
            { title: "Dial-in Permissions: Ensure VPN user accounts have the correct dial-in setting in Active Directory.", subs: ["Open the user properties in AD \u2192 Dial-in tab \u2192 select \u2018Control access through NPS Network Policy\u2019.", "If set to \u2018Deny access\u2019, NPS will reject the connection regardless of the network policy."] },
        ],
        ca: [
            { title: "Open the Certificate Templates console (certtmpl.msc)." },
            { title: "VPN Server Template: Required for RRAS and NPS server.", subs: ["Duplicate RAS and IAS Server. General tab: name AOVPN_Server.", "Compatibility tab: Set CA to Windows Server 2012 R2, recipient to Windows 8.1 or later.", "Subject Name tab: Select \u2018Supply in the request\u2019 so you can specify the external VPN FQDN as SAN during enrollment.", "Cryptography tab: Ensure minimum key size is 2048 bits (RSA).", "Security tab: Add the VPN server computer account and grant Read and Enroll permissions."] },
            { title: "Device Tunnel Template: Required for IKEv2 device authentication.", subs: ["Duplicate Computer Authentication. Name: AOVPN_Device.", "Subject Name tab: Select Build from this Active Directory information and format: DNS Name.", "Security tab: Add your device security group and grant Read, Enroll, and Autoenroll."] },
            { title: "User Tunnel Template: Required for SSTP user authentication.", subs: ["Duplicate User. Name: AOVPN_User.", "Security tab: Add your VPN user group (or Authenticated Users) and grant Read, Enroll, and Autoenroll."] },
            { title: "Publish Templates: Open the Certification Authority (certsrv.msc).", subs: ["Right-click Certificate Templates \u2192 New \u2192 Certificate Template to Issue. Select all three AOVPN templates."] },
            { title: "Enrollment:", subs: ["Use certlm.msc on the VPN server to manually request an AOVPN_Server certificate (ensure you specify the external DNS name as SAN!).", "In Group Policy (GPO), ensure \u2018Certificate Autoenrollment\u2019 is enabled in both Computer and User policies."] },
        ],
        adGpo: [
            { title: "Create Active Directory Groups:", subs: ["Create a security group for VPN devices (e.g. AOVPN_Devices). Add the computer objects that should establish the Device Tunnel.", "Create a security group for VPN users (e.g. AOVPN_Users). Add the employees who may use the User Tunnel.", "These groups are essential for certificate template permissions and NPS network policy conditions."] },
            { title: "Create a Group Policy (GPO) for Auto-Enrollment:", subs: ["In Group Policy Management, create a new GPO (e.g. AOVPN_Certificate_Policy) and link it at the level where your users and computers reside."] },
            { title: "Auto-request Computer Certificates (Device Tunnel):", subs: ["In the GPO: Computer Configuration \u2192 Policies \u2192 Windows Settings \u2192 Security Settings \u2192 Public Key Policies.", "Open Certificate Services Client \u2013 Auto-Enrollment. Set the configuration model to Enabled.", "Check \u2018Renew expired certificates\u2026\u2019 and \u2018Update certificates that use certificate templates\u2019."] },
            { title: "Auto-request User Certificates (User Tunnel):", subs: ["In the GPO: User Configuration \u2192 Policies \u2192 Windows Settings \u2192 Security Settings \u2192 Public Key Policies.", "Follow the exact same steps as the Computer Configuration (Enable & check both boxes)."] },
            { title: "Finalize: Run gpupdate /force on the clients or restart them after they have been added to the groups." },
        ],
        cdp: [
            { title: "Install IIS: Use the Install button above or run Install-WindowsFeature -Name Web-Server -IncludeManagementTools in an elevated PowerShell." },
            { title: "Create a CRL Virtual Directory in IIS Manager (inetmgr):", subs: ["Open IIS Manager \u2192 expand Sites \u2192 right-click Default Web Site \u2192 Add Virtual Directory.", "Alias: CertEnroll", "Physical Path: C:\\Windows\\System32\\CertSrv\\CertEnroll (this is the default CA publication folder).", "Click OK."] },
            { title: "Enable Double Escaping (required for Delta CRLs with + in the filename):", subs: ["Select the CertEnroll virtual directory.", "Open Request Filtering in the Features view.", "Click Edit Feature Settings\u2026 in the Actions pane.", "Check \u2018Allow double escaping\u2019 and click OK."] },
            { title: "Set Directory Browsing and Permissions:", subs: ["Select the CertEnroll virtual directory \u2192 open Directory Browsing \u2192 Enable.", "In Explorer, right-click the CertEnroll folder \u2192 Properties \u2192 Security \u2192 ensure the IIS_IUSRS group has Read permission."] },
            { title: "Configure CA CDP Extension (CRL Distribution Point):", subs: ["Open the CA console (certsrv.msc) \u2192 right-click the CA name \u2192 Properties \u2192 Extensions tab.", "Select CRL Distribution Point (CDP) from the dropdown.", "Click Add. Enter: http://crl.yourdomain.com/CertEnroll/<CaName><CRLNameSuffix><DeltaCRLAllowed>.crl", "Check \u2018Include in CRLs\u2019 and \u2018Include in the CDP extension of issued certificates\u2019.", "Remove or uncheck any LDAP-based CDP entries for external access (keep them for internal)."] },
            { title: "Configure CA AIA Extension (Authority Information Access):", subs: ["Still in the Extensions tab, switch dropdown to Authority Information Access (AIA).", "Click Add. Enter: http://crl.yourdomain.com/CertEnroll/<ServerDNSName>_<CaName><CertificateName>.crt", "Check \u2018Include in the AIA extension of issued certificates\u2019."] },
            { title: "Republish the CRL:", subs: ["In certsrv.msc, expand the CA \u2192 right-click Revoked Certificates \u2192 All Tasks \u2192 Publish.", "Select New CRL and click OK. This generates the .crl files in the CertEnroll folder.", "Restart the CA service: right-click the CA name \u2192 All Tasks \u2192 Stop Service, then Start Service."] },
            { title: "Firewall & DNS:", subs: ["Open TCP port 80 (HTTP) on the Windows Firewall and any perimeter firewall/NAT. CRL must NOT use HTTPS (port 443) \u2014 this is by design.", "Create an external DNS record (A record) for crl.yourdomain.com pointing to this server\u2019s public IP.", "If behind NAT, forward port 80 to this server."] },
            { title: "Test the CRL endpoint:", subs: ["From a client, open a browser and navigate to http://crl.yourdomain.com/CertEnroll/ \u2014 you should see .crl and .crt files.", "Run: certutil -URL http://crl.yourdomain.com/CertEnroll/YourCA.crl to verify retrieval.", "Run: certutil -verify -urlfetch <certificate.cer> to test the full chain including revocation."] },
        ],
    },
    de: {
        rras: [
            { title: "Verwenden Sie den Button unten, um die Routing und RAS Konsole (rrasmgmt.msc) zu \u00f6ffnen." },
            { title: "Klicken Sie mit der rechten Maustaste auf den Servernamen \u2192 Routing und RAS konfigurieren und aktivieren." },
            { title: "W\u00e4hlen Sie Benutzerdefinierte Konfiguration \u2192 aktivieren Sie VPN-Zugriff. Schlie\u00dfen Sie den Assistenten ab und starten Sie den Dienst, wenn Sie dazu aufgefordert werden." },
            { title: "IP-Adressvergabe: Rechtsklick auf den Servernamen \u2192 Eigenschaften \u2192 Tab IPv4.", subs: ["W\u00e4hlen Sie entweder DHCP oder legen Sie einen statischen Adresspool fest (klicken Sie auf Hinzuf\u00fcgen, um den Bereich wie 10.10.10.1 - 10.10.10.254 festzulegen)."] },
            { title: "Zertifikat & Authentifizierung: Rechtsklick auf den Servernamen \u2192 Eigenschaften \u2192 Tab Sicherheit.", subs: ["W\u00e4hlen Sie unten im Dropdown-Men\u00fc das SSL-Zertifikat f\u00fcr Ihre externe VPN-Adresse (z. B. vpn.firma.de) aus (f\u00fcr SSTP).", "Klicken Sie auf den Button Authentifizierungsmethoden\u2026 und stellen Sie sicher, dass Erweiterbares Authentifizierungsprotokoll (EAP) aktiviert ist."] },
            { title: "Ports anpassen: Erweitern Sie den Serverbaum, rechtsklicken Sie auf Ports \u2192 Eigenschaften.", subs: ["Konfigurieren Sie IKEv2-Ports (z. B. auf 128 setzen und \u201eRAS-Verbindungen\u201c aktivieren).", "Konfigurieren Sie SSTP-Ports (z. B. auf 128 setzen und \u201eRAS-Verbindungen\u201c aktivieren).", "Deaktivieren Sie PPTP und L2TP, indem Sie die Portanzahl auf 0 setzen und die RAS-H\u00e4kchen entfernen."] },
            { title: "Firewall-Regeln: Stellen Sie sicher, dass folgende Ports in der Windows-Firewall und jeder Perimeter-Firewall ge\u00f6ffnet sind:", subs: ["TCP 443 (SSTP)", "UDP 500 (IKEv2 ISAKMP)", "UDP 4500 (IKEv2 NAT-T)", "Falls der RRAS-Server hinter einem NAT-Ger\u00e4t steht, muss NAT-Traversal (NAT-T) unterst\u00fctzt werden."] },
            { title: "Dienst neu starten: Rechtsklick auf den Servernamen \u2192 Alle Aufgaben \u2192 Neu starten, um alle \u00c4nderungen anzuwenden." },
        ],
        nps: [
            { title: "NPS registrieren: \u00d6ffnen Sie die NPS-Konsole. Rechtsklicken Sie oben auf \u201eNPS\u201c und w\u00e4hlen Sie Server in Active Directory registrieren." },
            { title: "RADIUS-Clients: Erweitern Sie RADIUS-Clients und -Server. Rechtsklick auf RADIUS-Clients \u2192 Neu.", subs: ["Anzeigename: Local-RRAS", "Adresse (IP): 127.0.0.1", "Geben Sie ein starkes manuelles gemeinsames Geheimnis (Shared Secret) ein und best\u00e4tigen Sie es."] },
            { title: "Verbindungsanforderungsrichtlinien: Erweitern Sie Richtlinien \u2192 Rechtsklick Verbindungsanforderungsrichtlinien \u2192 Neu.", subs: ["Name: AOVPN Connection Request. Typ: \u201eRAS-Server (VPN-Einw\u00e4hlung)\u201c.", "Bedingungen: F\u00fcgen Sie NAS-Porttyp hinzu und w\u00e4hlen Sie Virtuell (VPN).", "Weiterleiten: Lassen Sie die Authentifizierung auf dem lokalen Server. Beenden."] },
            { title: "Netzwerkrichtlinien (Device Tunnel): Rechtsklick Netzwerkrichtlinien \u2192 Neu.", subs: ["Name: AOVPN Device Tunnel. Typ: \u201eRAS-Server (VPN-Einw\u00e4hlung)\u201c. Zugriff gew\u00e4hren.", "Bedingungen: NAS-Porttyp = Virtuell (VPN) UND Computer-Gruppen = (W\u00e4hlen Sie Ihre AD-Sicherheitsgruppe f\u00fcr VPN-Ger\u00e4te).", "Authentifizierungsmethoden: NUR \u201eErweiterbares Authentifizierungsprotokoll (EAP)\u201c aktivieren. F\u00fcgen Sie Microsoft: Smartcard- oder anderes Zertifikat hinzu. MS-CHAPv2 deaktivieren!", "Bearbeiten Sie den EAP-Typ und stellen Sie sicher, dass das Serverzertifikat des RRAS-Servers ausgew\u00e4hlt ist."] },
            { title: "Netzwerkrichtlinien (User Tunnel): Erstellen Sie eine weitere Netzwerkrichtlinie (oder duplizieren/anpassen).", subs: ["Name: AOVPN User Tunnel. Typ: \u201eRAS-Server (VPN-Einw\u00e4hlung)\u201c. Zugriff gew\u00e4hren.", "Bedingungen: NAS-Porttyp = Virtuell (VPN) UND Benutzergruppen = (Ihre AD-Sicherheitsgruppe f\u00fcr VPN-Benutzer).", "Authentifizierung: F\u00fcgen Sie Microsoft: Smartcard- oder anderes Zertifikat (oder PEAP f\u00fcr Windows Hello) hinzu. Bearbeiten und Serverzertifikat ausw\u00e4hlen."] },
            { title: "Richtlinien-Reihenfolge: NPS wertet Richtlinien von oben nach unten aus. Die Device Tunnel Richtlinie muss \u00dcBER der User Tunnel Richtlinie stehen.", subs: ["Rechtsklick auf jede Richtlinie, um die Verarbeitungsreihenfolge zu \u00e4ndern.", "Bei falscher Reihenfolge k\u00f6nnen Device-Verbindungen von der User-Richtlinie erfasst und abgelehnt werden."] },
            { title: "Einw\u00e4hlberechtigungen: Stellen Sie sicher, dass die VPN-Benutzerkonten die richtige Einw\u00e4hleinstellung im Active Directory haben.", subs: ["\u00d6ffnen Sie die Benutzereigenschaften in AD \u2192 Reiter Einw\u00e4hlen \u2192 w\u00e4hlen Sie \u201eZugriff \u00fcber NPS-Netzwerkrichtlinien steuern\u201c.", "Wenn \u201eZugriff verweigern\u201c eingestellt ist, lehnt NPS die Verbindung unabh\u00e4ngig von der Richtlinie ab."] },
        ],
        ca: [
            { title: "\u00d6ffnen Sie die Zertifikatsvorlagenkonsole (certtmpl.msc)." },
            { title: "VPN Server Vorlage: Erforderlich f\u00fcr den RRAS und NPS Server.", subs: ["Duplizieren Sie RAS- und IAS-Server. Tab Allgemein: Name AOVPN_Server.", "Tab Kompatibilit\u00e4t: Setzen Sie Zertifizierungsstelle auf Windows Server 2012 R2, Empf\u00e4nger auf Windows 8.1 oder h\u00f6her.", "Tab Antragstellername: W\u00e4hlen Sie \u201eInformationen werden in der Anforderung angegeben\u201c, damit Sie den externen VPN-FQDN als SAN bei der Registrierung angeben k\u00f6nnen.", "Tab Kryptografie: Stellen Sie sicher, dass die Mindestschl\u00fcsselgr\u00f6\u00dfe 2048 Bit (RSA) betr\u00e4gt.", "Tab Sicherheit: F\u00fcgen Sie das Computerkonto des VPN-Servers hinzu und gew\u00e4hren Sie ihm Lesen und Registrieren Rechte."] },
            { title: "Device Tunnel Vorlage: Erforderlich f\u00fcr die IKEv2-Ger\u00e4teauthentifizierung.", subs: ["Duplizieren Sie Computerauthentifizierung. Name: AOVPN_Device.", "Tab Antragsname: W\u00e4hlen Sie Aus diesen Informationen in Active Directory erstellen und Format: DNS-Name.", "Tab Sicherheit: F\u00fcgen Sie Ihre Ger\u00e4te-Sicherheitsgruppe hinzu und gew\u00e4hren Sie Lesen, Registrieren und Automatisch registrieren."] },
            { title: "User Tunnel Vorlage: Erforderlich f\u00fcr die SSTP-Benutzerauthentifizierung.", subs: ["Duplizieren Sie Benutzer. Name: AOVPN_User.", "Tab Sicherheit: F\u00fcgen Sie Ihre VPN-Benutzergruppe (oder Authentifizierte Benutzer) hinzu und gew\u00e4hren Sie Lesen, Registrieren und Automatisch registrieren."] },
            { title: "Vorlagen ausstellen (Publish): \u00d6ffnen Sie die Zertifizierungsstelle (certsrv.msc).", subs: ["Rechtsklick auf Zertifikatsvorlagen \u2192 Neu \u2192 Auszustellende Zertifikatsvorlage. W\u00e4hlen Sie alle drei AOVPN-Vorlagen."] },
            { title: "Enrollment:", subs: ["Verwenden Sie certlm.msc auf dem VPN-Server, um manuell ein AOVPN_Server-Zertifikat anzufordern (stellen Sie sicher, dass Sie den externen DNS-Namen als alternativen Namen (SAN) angeben!).", "Stellen Sie in der Gruppenrichtlinie (GPO) sicher, dass die \u201eZertifikatautoregistrierung\u201c in den Computer- und Benutzerrichtlinien aktiviert ist."] },
        ],
        adGpo: [
            { title: "Active Directory Gruppen erstellen:", subs: ["Erstellen Sie eine Sicherheitsgruppe f\u00fcr VPN-Ger\u00e4te (z.B. AOVPN_Ger\u00e4te). F\u00fcgen Sie die Computerobjekte hinzu, die den Device Tunnel aufbauen sollen.", "Erstellen Sie eine Sicherheitsgruppe f\u00fcr VPN-Benutzer (z.B. AOVPN_Benutzer). F\u00fcgen Sie die Mitarbeiter hinzu, die den User Tunnel nutzen d\u00fcrfen.", "Diese Gruppen sind essentiell f\u00fcr die Berechtigungen auf den Zertifikatsvorlagen und die Bedingungen in den NPS-Netzwerkrichtlinien."] },
            { title: "Gruppenrichtlinie (GPO) f\u00fcr Auto-Enrollment anlegen:", subs: ["Erstellen Sie in der Gruppenrichtlinienverwaltung ein neues GPO (z.B. AOVPN_Zertifikate_Richtlinie) und verkn\u00fcpfen Sie es auf der Ebene, wo sich Ihre Benutzer und Computer befinden."] },
            { title: "Computer-Zertifikate automatisch anfordern (Device Tunnel):", subs: ["In der GPO: Computerkonfiguration \u2192 Richtlinien \u2192 Windows-Einstellungen \u2192 Sicherheitseinstellungen \u2192 Richtlinien f\u00fcr \u00f6ffentliche Schl\u00fcssel.", "\u00d6ffnen Sie Zertifikatdiensteclient - automatische Zertifikatanforderung. Stellen Sie das Konfigurationsmodell auf Aktiviert.", "Setzen Sie Haken bei \u201eZertifikate, die widerrufen...\u201c und \u201eZertifikate, die Zertifikatvorlagen verwenden, aktualisieren\u201c."] },
            { title: "Benutzer-Zertifikate automatisch anfordern (User Tunnel):", subs: ["In der GPO: Benutzerkonfiguration \u2192 Richtlinien \u2192 Windows-Einstellungen \u2192 Sicherheitseinstellungen \u2192 Richtlinien f\u00fcr \u00f6ffentliche Schl\u00fcssel.", "F\u00fchren Sie exakt dieselben Schritte wie bei der Computerkonfiguration aus (Aktivieren & beide Haken setzen)."] },
            { title: "Abschluss: F\u00fchren Sie auf den Clients gpupdate /force aus oder starten Sie sie neu, nachdem sie den Gruppen hinzugef\u00fcgt wurden." },
        ],
        cdp: [
            { title: "IIS installieren: Verwenden Sie den Installieren-Button oben oder f\u00fchren Sie Install-WindowsFeature -Name Web-Server -IncludeManagementTools in einer erh\u00f6hten PowerShell aus." },
            { title: "Virtuelles CRL-Verzeichnis im IIS-Manager (inetmgr) erstellen:", subs: ["\u00d6ffnen Sie den IIS-Manager \u2192 erweitern Sie Sites \u2192 Rechtsklick auf Standardwebsite \u2192 Virtuelles Verzeichnis hinzuf\u00fcgen.", "Alias: CertEnroll", "Physischer Pfad: C:\\Windows\\System32\\CertSrv\\CertEnroll (Dies ist der Standard-Ver\u00f6ffentlichungsordner der Zertifizierungsstelle).", "Klicken Sie auf OK."] },
            { title: "Doppeltes Escaping aktivieren (erforderlich f\u00fcr Delta-Sperrlisten mit + im Dateinamen):", subs: ["W\u00e4hlen Sie das virtuelle Verzeichnis CertEnroll aus.", "\u00d6ffnen Sie Anforderungsfilterung in der Featureansicht.", "Klicken Sie im Aktionsbereich auf Featureeinstellungen bearbeiten\u2026", "Setzen Sie den Haken bei \u201eDoppeltes Escaping zulassen\u201c und klicken Sie auf OK."] },
            { title: "Verzeichnissuche und Berechtigungen:", subs: ["W\u00e4hlen Sie das CertEnroll-Verzeichnis \u2192 \u00f6ffnen Sie Verzeichnissuche \u2192 Aktivieren.", "Im Explorer: Rechtsklick auf den CertEnroll-Ordner \u2192 Eigenschaften \u2192 Sicherheit \u2192 stellen Sie sicher, dass die Gruppe IIS_IUSRS Leserechte hat."] },
            { title: "CDP-Erweiterung der Zertifizierungsstelle konfigurieren:", subs: ["\u00d6ffnen Sie die Zertifizierungsstellen-Konsole (certsrv.msc) \u2192 Rechtsklick auf den CA-Namen \u2192 Eigenschaften \u2192 Reiter Erweiterungen.", "W\u00e4hlen Sie im Dropdown Sperrlisten-Verteilungspunkt (CDP).", "Klicken Sie auf Hinzuf\u00fcgen. Geben Sie ein: http://crl.ihredomain.de/CertEnroll/<CaName><CRLNameSuffix><DeltaCRLAllowed>.crl", "Setzen Sie Haken bei \u201eIn Sperrlisten einbeziehen\u201c und \u201eIn CDP-Erweiterung ausgestellter Zertifikate einbeziehen\u201c.", "Entfernen oder deaktivieren Sie LDAP-basierte CDP-Eintr\u00e4ge f\u00fcr externen Zugriff (intern beibehalten)."] },
            { title: "AIA-Erweiterung konfigurieren (Zugriff auf Stelleninformationen):", subs: ["Wechseln Sie im Dropdown auf Zugriff auf Stelleninformationen (AIA).", "Klicken Sie auf Hinzuf\u00fcgen. Geben Sie ein: http://crl.ihredomain.de/CertEnroll/<ServerDNSName>_<CaName><CertificateName>.crt", "Setzen Sie den Haken bei \u201eIn AIA-Erweiterung ausgestellter Zertifikate einbeziehen\u201c."] },
            { title: "Sperrliste neu ver\u00f6ffentlichen:", subs: ["In certsrv.msc: Erweitern Sie die CA \u2192 Rechtsklick auf Gesperrte Zertifikate \u2192 Alle Aufgaben \u2192 Ver\u00f6ffentlichen.", "W\u00e4hlen Sie Neue Sperrliste und klicken Sie auf OK. Dies generiert die .crl-Dateien im CertEnroll-Ordner.", "Starten Sie den CA-Dienst neu: Rechtsklick auf den CA-Namen \u2192 Alle Aufgaben \u2192 Dienst beenden, dann Dienst starten."] },
            { title: "Firewall & DNS:", subs: ["\u00d6ffnen Sie TCP Port 80 (HTTP) in der Windows-Firewall und jeder Perimeter-Firewall/NAT. CRL darf NICHT \u00fcber HTTPS (Port 443) bereitgestellt werden \u2014 das ist beabsichtigt.", "Erstellen Sie einen externen DNS-Eintrag (A-Record) f\u00fcr crl.ihredomain.de, der auf die \u00f6ffentliche IP dieses Servers zeigt.", "Falls hinter NAT: Leiten Sie Port 80 an diesen Server weiter."] },
            { title: "CRL-Endpunkt testen:", subs: ["\u00d6ffnen Sie von einem Client aus einen Browser und navigieren Sie zu http://crl.ihredomain.de/CertEnroll/ \u2014 Sie sollten .crl- und .crt-Dateien sehen.", "F\u00fchren Sie aus: certutil -URL http://crl.ihredomain.de/CertEnroll/IhreCA.crl um den Abruf zu pr\u00fcfen.", "F\u00fchren Sie aus: certutil -verify -urlfetch <zertifikat.cer> um die gesamte Kette inkl. Sperrpr\u00fcfung zu testen."] },
        ],
    },
};
